import{M as ye,N as P,S as W,i as G,s as Q,e as D,t as U,k as N,c as E,a as I,h as A,m as j,d as T,b as k,g as V,G as b,j as ee,O as ne,P as se,Q as O,R as x,T as ie,H as L,U as B,V as me,W as te,w as z,x as Y,y as Z,X as q,q as H,o as R,B as $,n as ge,p as pe,v as ve,Y as M,Z as be,_ as oe}from"../chunks/vendor-e309547f.js";import{c as F}from"../chunks/singletons-d1fb5791.js";import{g as ke,l as Te,a as we,s as De,c as Ee}from"../chunks/Config-d1aac259.js";import"../chunks/Defaults-2a83e164.js";F.disable_scroll_handling;const Ie=F.goto;F.invalidate;F.prefetch;F.prefetch_routes;F.before_navigate;F.after_navigate;class Ke{}function Ne(){return`https://api.atlassian.com/ex/jira/${Te().jira.cloudId}/`}async function je(){const e=Te(),t={grant_type:"refresh_token",client_id:e.jira.clientId,client_secret:e.jira.clientSecret,refresh_token:we()},i=await(await fetch("https://auth.atlassian.com/oauth/token",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}})).json();console.log(i),De(i.access_token,i.refresh_token)}async function Ve(e){const t=Ne(),n=ke(),i=ye(n);return P.fromMillis(i.exp*1e3)<P.now()&&(console.log("updated token with refresh token"),await je()),await(await fetch(`${t}${e}`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}})).json()}async function Ce(e){return await Ve(`rest/api/3/issue/picker?query=${e}&currentJQL=`)}function ae(e,t,n){const i=e.slice();return i[8]=t[n],i}function re(e,t,n){const i=e.slice();return i[11]=t[n],i}function le(e){let t,n,i,d=e[11].keyHtml+"",h,c,f=e[11].summary+"",u,l;function o(){return e[7](e[11])}return{c(){t=D("div"),n=D("button"),i=new ne,h=N(),c=new ne,this.h()},l(s){t=E(s,"DIV",{});var a=I(t);n=E(a,"BUTTON",{class:!0});var p=I(n);i=se(p),h=j(p),c=se(p),p.forEach(T),a.forEach(T),this.h()},h(){i.a=h,c.a=null,k(n,"class","p-1 rounded-sm svelte-1gl1x03")},m(s,a){V(s,t,a),b(t,n),i.m(d,n),b(n,h),c.m(f,n),u||(l=O(n,"click",o),u=!0)},p(s,a){e=s,a&1&&d!==(d=e[11].keyHtml+"")&&i.p(d),a&1&&f!==(f=e[11].summary+"")&&c.p(f)},d(s){s&&T(t),u=!1,l()}}}function ue(e){let t,n=e[8].label+"",i,d,h,c=e[8].issues,f=[];for(let u=0;u<c.length;u+=1)f[u]=le(re(e,c,u));return{c(){t=D("div"),i=U(n),d=N();for(let u=0;u<f.length;u+=1)f[u].c();h=N(),this.h()},l(u){t=E(u,"DIV",{class:!0});var l=I(t);i=A(l,n),d=j(l);for(let o=0;o<f.length;o+=1)f[o].l(l);h=j(l),l.forEach(T),this.h()},h(){k(t,"class","section pb-2")},m(u,l){V(u,t,l),b(t,i),b(t,d);for(let o=0;o<f.length;o+=1)f[o].m(t,null);b(t,h)},p(u,l){if(l&1&&n!==(n=u[8].label+"")&&ee(i,n),l&17){c=u[8].issues;let o;for(o=0;o<c.length;o+=1){const s=re(u,c,o);f[o]?f[o].p(s,l):(f[o]=le(s),f[o].c(),f[o].m(t,h))}for(;o<f.length;o+=1)f[o].d(1);f.length=c.length}},d(u){u&&T(t),x(f,u)}}}function Ue(e){let t,n,i,d,h,c,f=e[0],u=[];for(let l=0;l<f.length;l+=1)u[l]=ue(ae(e,f,l));return{c(){t=D("div"),n=D("input"),i=N(),d=D("div");for(let l=0;l<u.length;l+=1)u[l].c();this.h()},l(l){t=E(l,"DIV",{class:!0});var o=I(t);n=E(o,"INPUT",{type:!0,placeholder:!0,class:!0}),i=j(o),d=E(o,"DIV",{class:!0});var s=I(d);for(let a=0;a<u.length;a+=1)u[a].l(s);s.forEach(T),o.forEach(T),this.h()},h(){k(n,"type","text"),k(n,"placeholder","issue"),k(n,"class","svelte-1gl1x03"),k(d,"class","suggestions p-2 svelte-1gl1x03"),ie(d,"open",e[2]),k(t,"class","search svelte-1gl1x03")},m(l,o){V(l,t,o),b(t,n),e[6](n),b(t,i),b(t,d);for(let s=0;s<u.length;s+=1)u[s].m(d,null);h||(c=O(n,"keyup",e[3]),h=!0)},p(l,[o]){if(o&17){f=l[0];let s;for(s=0;s<f.length;s+=1){const a=ae(l,f,s);u[s]?u[s].p(a,o):(u[s]=ue(a),u[s].c(),u[s].m(d,null))}for(;s<u.length;s+=1)u[s].d(1);u.length=f.length}o&4&&ie(d,"open",l[2])},i:L,o:L,d(l){l&&T(t),e[6](null),x(u,l),h=!1,c()}}}function Ae(e,t,n){let{issueKey:i}=t,d=[],h,c=!1;async function f(s){if(!s.target.value)return;const p=await Ce(s.target.value);n(0,d=p.sections),n(2,c=!0)}async function u(s,a){n(1,h.value=`${s} - ${a}`,h),n(2,c=!1),n(5,i=s)}function l(s){B[s?"unshift":"push"](()=>{h=s,n(1,h)})}const o=s=>u(s.key,s.summaryText);return e.$$set=s=>{"issueKey"in s&&n(5,i=s.issueKey)},[d,h,c,f,u,i,l,o]}class Be extends W{constructor(t){super();G(this,t,Ae,Ue,Q,{issueKey:5})}}function Oe(e){let t,n,i,d,h,c,f,u,l,o,s,a;return{c(){t=D("div"),n=D("input"),i=N(),d=D("button"),h=U("Now"),c=N(),f=D("input"),u=N(),l=D("button"),o=U("Now"),this.h()},l(p){t=E(p,"DIV",{class:!0});var r=I(t);n=E(r,"INPUT",{type:!0,class:!0}),i=j(r),d=E(r,"BUTTON",{class:!0});var _=I(d);h=A(_,"Now"),_.forEach(T),c=j(r),f=E(r,"INPUT",{type:!0,class:!0}),u=j(r),l=E(r,"BUTTON",{class:!0});var g=I(l);o=A(g,"Now"),g.forEach(T),r.forEach(T),this.h()},h(){k(n,"type","time"),k(n,"class","start"),k(d,"class","button is-primary"),k(f,"type","time"),k(f,"class","end"),k(l,"class","button is-primary"),k(t,"class","duration svelte-1o9cuq5")},m(p,r){V(p,t,r),b(t,n),e[8](n),b(t,i),b(t,d),b(d,h),b(t,c),b(t,f),e[9](f),b(t,u),b(t,l),b(l,o),s||(a=[O(n,"change",e[2]),O(d,"click",e[3]),O(f,"change",e[2]),O(l,"click",e[4])],s=!0)},p:L,i:L,o:L,d(p){p&&T(t),e[8](null),e[9](null),s=!1,me(a)}}}function He(e,t,n){let{duration:i}=t,{startTime:d}=t,{endTime:h}=t,c,f;const u=te();function l(){n(7,h=P.fromFormat(f.value,"HH:mm")),n(6,d=P.fromFormat(c.value,"HH:mm")),n(5,i=h.diff(d)),u("change")}function o(){return P.local().toFormat("HH:mm")}function s(){n(0,c.value=o(),c)}function a(){n(1,f.value=o(),f)}function p(_){B[_?"unshift":"push"](()=>{c=_,n(0,c)})}function r(_){B[_?"unshift":"push"](()=>{f=_,n(1,f)})}return e.$$set=_=>{"duration"in _&&n(5,i=_.duration),"startTime"in _&&n(6,d=_.startTime),"endTime"in _&&n(7,h=_.endTime)},[c,f,l,s,a,i,d,h,p,r]}class Se extends W{constructor(t){super();G(this,t,He,Oe,Q,{duration:5,startTime:6,endTime:7})}}class ce{}function fe(e,t,n){const i=e.slice();return i[8]=t[n].duration,i[9]=t[n].startTime,i[10]=t[n].endTime,i[11]=t,i[12]=n,i}function de(e){let t,n,i,d,h,c;function f(s){e[4](s,e[8],e[11],e[12])}function u(s){e[5](s,e[9],e[11],e[12])}function l(s){e[6](s,e[10],e[11],e[12])}let o={};return e[8]!==void 0&&(o.duration=e[8]),e[9]!==void 0&&(o.startTime=e[9]),e[10]!==void 0&&(o.endTime=e[10]),n=new Se({props:o}),B.push(()=>M(n,"duration",f)),B.push(()=>M(n,"startTime",u)),B.push(()=>M(n,"endTime",l)),n.$on("change",e[2]),{c(){t=D("div"),z(n.$$.fragment),this.h()},l(s){t=E(s,"DIV",{class:!0});var a=I(t);Y(n.$$.fragment,a),a.forEach(T),this.h()},h(){k(t,"class","mb-2")},m(s,a){V(s,t,a),Z(n,t,null),c=!0},p(s,a){e=s;const p={};!i&&a&1&&(i=!0,p.duration=e[8],q(()=>i=!1)),!d&&a&1&&(d=!0,p.startTime=e[9],q(()=>d=!1)),!h&&a&1&&(h=!0,p.endTime=e[10],q(()=>h=!1)),n.$set(p)},i(s){c||(H(n.$$.fragment,s),c=!0)},o(s){R(n.$$.fragment,s),c=!1},d(s){s&&T(t),$(n)}}}function qe(e){let t,n,i,d,h,c,f,u,l,o,s=e[0],a=[];for(let r=0;r<s.length;r+=1)a[r]=de(fe(e,s,r));const p=r=>R(a[r],1,1,()=>{a[r]=null});return{c(){t=D("div"),n=U("Duration: "),i=U(e[1]),d=N();for(let r=0;r<a.length;r+=1)a[r].c();h=N(),c=D("button"),f=U("Add Duration"),this.h()},l(r){t=E(r,"DIV",{class:!0});var _=I(t);n=A(_,"Duration: "),i=A(_,e[1]),_.forEach(T),d=j(r);for(let y=0;y<a.length;y+=1)a[y].l(r);h=j(r),c=E(r,"BUTTON",{class:!0});var g=I(c);f=A(g,"Add Duration"),g.forEach(T),this.h()},h(){k(t,"class","mb-1"),k(c,"class","button is-primary mb-2 svelte-100yq62")},m(r,_){V(r,t,_),b(t,n),b(t,i),V(r,d,_);for(let g=0;g<a.length;g+=1)a[g].m(r,_);V(r,h,_),V(r,c,_),b(c,f),u=!0,l||(o=O(c,"click",e[3]),l=!0)},p(r,[_]){if((!u||_&2)&&ee(i,r[1]),_&5){s=r[0];let g;for(g=0;g<s.length;g+=1){const y=fe(r,s,g);a[g]?(a[g].p(y,_),H(a[g],1)):(a[g]=de(y),a[g].c(),H(a[g],1),a[g].m(h.parentNode,h))}for(ge(),g=s.length;g<a.length;g+=1)p(g);pe()}},i(r){if(!u){for(let _=0;_<s.length;_+=1)H(a[_]);u=!0}},o(r){a=a.filter(Boolean);for(let _=0;_<a.length;_+=1)R(a[_]);u=!1},d(r){r&&T(t),r&&T(d),x(a,r),r&&T(h),r&&T(c),l=!1,o()}}}function Me(e,t,n){let{durations:i=[]}=t,d="--:--";const h=te();ve(()=>{n(0,i=[new ce])});function c(){let s=be.fromMillis(0);i.forEach(a=>{a.duration.values!=null&&a.duration.values.milliseconds!=null&&(s=s.plus(a.duration))}),n(1,d=s.toFormat("hh:mm")),h("change")}function f(){n(0,i=[...i,new ce])}function u(s,a,p,r){p[r].duration=s,n(0,i)}function l(s,a,p,r){p[r].startTime=s,n(0,i)}function o(s,a,p,r){p[r].endTime=s,n(0,i)}return e.$$set=s=>{"durations"in s&&n(0,i=s.durations)},[i,d,c,f,u,l,o]}class Re extends W{constructor(t){super();G(this,t,Me,qe,Q,{durations:0})}}function Fe(e){let t,n,i,d,h,c,f,u,l,o,s,a,p,r,_,g;function y(m){e[4](m)}let X={};e[1]!==void 0&&(X.issueKey=e[1]),c=new Be({props:X}),B.push(()=>M(c,"issueKey",y));function v(m){e[6](m)}let w={};return e[2]!==void 0&&(w.durations=e[2]),a=new Re({props:w}),B.push(()=>M(a,"durations",v)),a.$on("change",e[3]),{c(){t=D("div"),n=D("div"),i=D("div"),d=U("Ticket & description"),h=N(),z(c.$$.fragment),u=N(),l=D("textarea"),o=N(),s=D("div"),z(a.$$.fragment),this.h()},l(m){t=E(m,"DIV",{class:!0});var K=I(t);n=E(K,"DIV",{class:!0});var C=I(n);i=E(C,"DIV",{class:!0});var S=I(i);d=A(S,"Ticket & description"),S.forEach(T),h=j(C),Y(c.$$.fragment,C),u=j(C),l=E(C,"TEXTAREA",{class:!0}),I(l).forEach(T),C.forEach(T),o=j(K),s=E(K,"DIV",{class:!0});var J=I(s);Y(a.$$.fragment,J),J.forEach(T),K.forEach(T),this.h()},h(){k(i,"class","mb-1"),k(l,"class","mt-2 svelte-9u51ym"),k(n,"class","left pr-2 svelte-9u51ym"),k(s,"class","right svelte-9u51ym"),k(t,"class","task p-2 mb-2 rounded-md svelte-9u51ym")},m(m,K){V(m,t,K),b(t,n),b(n,i),b(i,d),b(n,h),Z(c,n,null),b(n,u),b(n,l),oe(l,e[0]),b(t,o),b(t,s),Z(a,s,null),r=!0,_||(g=O(l,"input",e[5]),_=!0)},p(m,[K]){const C={};!f&&K&2&&(f=!0,C.issueKey=m[1],q(()=>f=!1)),c.$set(C),K&1&&oe(l,m[0]);const S={};!p&&K&4&&(p=!0,S.durations=m[2],q(()=>p=!1)),a.$set(S)},i(m){r||(H(c.$$.fragment,m),H(a.$$.fragment,m),r=!0)},o(m){R(c.$$.fragment,m),R(a.$$.fragment,m),r=!1},d(m){m&&T(t),$(c),$(a),_=!1,g()}}}function Je(e,t,n){let{description:i=""}=t,{issueKey:d=""}=t,{durations:h=[]}=t,c=te();function f(){c("timeChange")}function u(s){d=s,n(1,d)}function l(){i=this.value,n(0,i)}function o(s){h=s,n(2,h)}return e.$$set=s=>{"description"in s&&n(0,i=s.description),"issueKey"in s&&n(1,d=s.issueKey),"durations"in s&&n(2,h=s.durations)},e.$$.update=()=>{e.$$.dirty&3&&c("textChange",{issueKey:d,description:i})},[i,d,h,f,u,l,o]}class Pe extends W{constructor(t){super();G(this,t,Je,Fe,Q,{description:0,issueKey:1,durations:2})}}function he(e,t,n){const i=e.slice();return i[11]=t[n],i[12]=t,i[13]=n,i}function _e(e){let t,n,i,d,h;function c(o){e[8](o,e[11])}function f(o){e[9](o,e[11])}function u(o){e[10](o,e[11])}let l={};return e[11].description!==void 0&&(l.description=e[11].description),e[11].issue!==void 0&&(l.issueKey=e[11].issue),e[11].durations!==void 0&&(l.durations=e[11].durations),t=new Pe({props:l}),B.push(()=>M(t,"description",c)),B.push(()=>M(t,"issueKey",f)),B.push(()=>M(t,"durations",u)),t.$on("timeChange",e[3]),t.$on("textChange",e[4]),{c(){z(t.$$.fragment)},l(o){Y(t.$$.fragment,o)},m(o,s){Z(t,o,s),h=!0},p(o,s){e=o;const a={};!n&&s&1&&(n=!0,a.description=e[11].description,q(()=>n=!1)),!i&&s&1&&(i=!0,a.issueKey=e[11].issue,q(()=>i=!1)),!d&&s&1&&(d=!0,a.durations=e[11].durations,q(()=>d=!1)),t.$set(a)},i(o){h||(H(t.$$.fragment,o),h=!0)},o(o){R(t.$$.fragment,o),h=!1},d(o){$(t,o)}}}function Le(e){let t,n,i,d,h,c,f,u,l,o,s,a,p,r,_,g=e[0],y=[];for(let v=0;v<g.length;v+=1)y[v]=_e(he(e,g,v));const X=v=>R(y[v],1,1,()=>{y[v]=null});return{c(){t=D("div"),n=D("div"),i=U("Total Duration: "),d=U(e[1]),h=N(),c=D("div"),f=D("button"),u=U("Download"),l=N();for(let v=0;v<y.length;v+=1)y[v].c();o=N(),s=D("button"),a=U("Add Task"),this.h()},l(v){t=E(v,"DIV",{class:!0});var w=I(t);n=E(w,"DIV",{class:!0});var m=I(n);i=A(m,"Total Duration: "),d=A(m,e[1]),m.forEach(T),h=j(w),c=E(w,"DIV",{class:!0});var K=I(c);f=E(K,"BUTTON",{class:!0});var C=I(f);u=A(C,"Download"),C.forEach(T),K.forEach(T),w.forEach(T),l=j(v);for(let J=0;J<y.length;J+=1)y[J].l(v);o=j(v),s=E(v,"BUTTON",{class:!0});var S=I(s);a=A(S,"Add Task"),S.forEach(T),this.h()},h(){k(n,"class","left"),k(f,"class","button is-primary mt-1"),k(c,"class","right"),k(t,"class","mb-2 header svelte-19gutxg"),k(s,"class","button is-primary mt-1 add-task svelte-19gutxg")},m(v,w){V(v,t,w),b(t,n),b(n,i),b(n,d),b(t,h),b(t,c),b(c,f),b(f,u),V(v,l,w);for(let m=0;m<y.length;m+=1)y[m].m(v,w);V(v,o,w),V(v,s,w),b(s,a),p=!0,r||(_=[O(f,"click",e[5]),O(s,"click",e[2])],r=!0)},p(v,[w]){if((!p||w&2)&&ee(d,v[1]),w&25){g=v[0];let m;for(m=0;m<g.length;m+=1){const K=he(v,g,m);y[m]?(y[m].p(K,w),H(y[m],1)):(y[m]=_e(K),y[m].c(),H(y[m],1),y[m].m(o.parentNode,o))}for(ge(),m=g.length;m<y.length;m+=1)X(m);pe()}},i(v){if(!p){for(let w=0;w<g.length;w+=1)H(y[w]);p=!0}},o(v){y=y.filter(Boolean);for(let w=0;w<y.length;w+=1)R(y[w]);p=!1},d(v){v&&T(t),v&&T(l),x(y,v),v&&T(o),v&&T(s),r=!1,me(_)}}}function We(e,t,n){var i=document.createElement("a"),d=new Blob([e],{type:n});i.href=URL.createObjectURL(d),i.download=t,i.click()}function Ge(e,t,n){let i=[],d="--:--",h=!1,c=!1;ve(()=>{Ee()?f():Ie("/upload/config"),n(7,c=!0)});function f(){n(0,i=[...i,new Ke])}function u(){let r=be.fromMillis(0);i.forEach(_=>{_.durations.forEach(g=>{g.duration.values!=null&&g.duration.values.milliseconds!=null&&(r=r.plus(g.duration))})}),n(1,d=r.toFormat("hh:mm")),n(6,h=!0)}function l(){n(6,h=!0)}function o(){n(6,h=!1);const r=P.now().toFormat("dd-MM-yyyy");We(JSON.stringify(i),`tasks_${r}.json`,"application/json")}function s(r,_){e.$$.not_equal(_.description,r)&&(_.description=r,n(0,i))}function a(r,_){e.$$.not_equal(_.issue,r)&&(_.issue=r,n(0,i))}function p(r,_){e.$$.not_equal(_.durations,r)&&(_.durations=r,n(0,i))}return e.$$.update=()=>{e.$$.dirty&192&&c&&(console.log(h),h?window.onbeforeunload=function(){return!0}:window.onbeforeunload=null)},[i,d,f,u,l,o,h,c,s,a,p]}class Ze extends W{constructor(t){super();G(this,t,Ge,Le,Q,{})}}export{Ze as default};
