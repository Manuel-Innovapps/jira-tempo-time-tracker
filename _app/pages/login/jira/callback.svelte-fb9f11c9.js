import{Y as u,S as d,i as g,s as b,e as h,t as m,c as _,a as f,h as v,d as i,b as c,g as y,G as x,H as o,Z as C,v as S}from"../../../chunks/vendor-bad6d441.js";import{l as j,s as k}from"../../../chunks/Config-e5e786dd.js";import{g as G}from"../../../chunks/JiraLogin-a8e2d14b.js";import"../../../chunks/Defaults-0244c464.js";const J=()=>{const t=u("__svelte__");return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},get preloading(){return console.error("stores.preloading is deprecated; use stores.navigating instead"),{subscribe:t.navigating.subscribe}},session:t.session,updated:t.updated}},T={subscribe(t){return J().page.subscribe(t)}};function $(t){let e,n;return{c(){e=h("a"),n=m("Go to application"),this.h()},l(s){e=_(s,"A",{href:!0,class:!0});var a=f(e);n=v(a,"Go to application"),a.forEach(i),this.h()},h(){c(e,"href","/"),c(e,"class","button is-primary")},m(s,a){y(s,e,a),x(e,n)},p:o,i:o,o,d(s){s&&i(e)}}}function w(t,e,n){let s;return C(t,T,a=>n(0,s=a)),S(async()=>{const a=s.url.searchParams.get("code"),r=j(),p={grant_type:"authorization_code",client_id:r.jira.clientId,client_secret:r.jira.clientSecret,code:a,redirect_uri:G()},l=await(await fetch("https://auth.atlassian.com/oauth/token",{method:"POST",body:JSON.stringify(p),headers:{"Content-Type":"application/json"}})).json();k(l.access_token)}),[]}class E extends d{constructor(e){super();g(this,e,w,$,b,{})}}export{E as default};
